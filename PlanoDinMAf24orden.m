function PlanoDinMAf24orden
%Dibuja el plano dinámico del método (MA4O) para la función f_2(x)

li=-3;ls=3;%Definimos los límites para los intervalos
N=500; maxiter=80; tol=1e-6;
x=linspace(li,ls,N); y=x;
[X,Y]=meshgrid(x,y);
z=X+1i*Y;

%Raíces de f_2(x)
raices=[-1.2511518352207648115928700687882, 0.55000934992726156666495361947173];

%Operador de punto fijo
R=@(z)(632*z^4 + 4112*z^5 + 10416*z^6 + 12032*z^7 + 5312*z^8 + 128*cos(z)^4 + 621*sin(2*z) + 6858*z*sin(2*z) + 65664*z^3*sin(2*z) + 71280*z^4*sin(2*z) + 108*z*sin(2*z)^2 +... 
   108*z^2*sin(2*z)^2 - 18*csc(z)*sin(2*z)^3 + 162*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
   2214*z^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + 11700*z^3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
   32040*z^4*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + 48816*z^5*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
   39456*z^6*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + 13248*z^7*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - ...
   81*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - 513*z^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - ...
   1296*z^3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - 1728*z^4*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - ...
   1296*z^5*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - 432*z^6*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - ...
   54*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3 - 378*z^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3 - ...
   972*z^3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3 - 1080*z^4*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3 -... 
   432*z^5*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3 + 27*z*sin(z)^6*(1 + 9*z + 8*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) + ...
   18*z*sin(z)^5*(6 + 74*z + 140*z^2 + 3*(23 + 47*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) + ...
   16*cos(z)^3*(9 + 4*z + 4*z^2 + 18*(1 + 2*z + sin(z))*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) + ...
   9*z*sin(z)^4*(8*(3 + 41*z + 146*z^2 + 153*z^3) + 12*(29 + 117*z + 118*z^2)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
     9*(1 + z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2) + ...
   18*z*sin(z)^3*(15 + 189*z + 926*z^2 + 1920*z^3 + 1408*z^4 + 3*(79 + 471*z + 944*z^2 + 632*z^3)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
     9*(1 + 3*z + 2*z^2)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - 3*(1 + z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3) + ...
   18*z*sin(z)*((1 + 2*z)^3*(3 + 11*z + 80*z^2 + 144*z^3) + 3648*z^2*sin(2*z) + 2*sin(2*z)^2 + (66 + 678*z + 2744*z^2 + 5532*z^3 + 5568*z^4 + 2240*z^5)*...
      sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - 3*(3 + 13*z + 22*z^2 + 20*z^3 + 8*z^4)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - ...
     9*(1 + z)*(1 + 2*z)^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3) + ...
   9*z*sin(z)^2*(21 + 229*z + 1328*z^2 + 4104*z^3 + 6176*z^4 + 3552*z^5 + 6*(59 + 469*z + 1406*z^2 + 1880*z^3 + 944*z^4)*...
      sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + 24*z*(1 + z)^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 - ...
     18*(1 + 3*z + 2*z^2)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3) + ...
   24*cos(z)^2*(3 + 6*z + 14*z^2 + 16*z^3 + 8*z^4 + 3*sin(z)^4 + sin(z)^3*(3 - 9*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) + ...
     9*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + 9*(1 + 2*z)^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
     9*sin(z)^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))*(-1 - 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) + ...
     3*sin(z)*((1 + 2*z)^3 + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + 6*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2)) + ...
   cos(z)*(8*(27 + 342*z + 1872*z^2 + 5444*z^3 + 8862*z^4 + 7656*z^5 + 2744*z^6) + 189*sin(z)^6 + 54*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - ...
     27*(1 + 2*z)^2*(-3 + 4*z + 4*z^2)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
     54*(1 + 2*z)^3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3 + ...
     18*sin(z)^5*(66 + 148*z + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) + ...
     9*sin(z)^4*(16*(21 + 93*z + 103*z^2) + 12*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - ...
       9*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2) + 18*sin(z)^3*(225 + 1502*z + 3316*z^2 + 2424*z^3 + ...
       (3 + 36*z + 36*z^2)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - 9*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
       3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3) + 9*sin(z)^2*(339 + 3032*z + 10008*z^2 + 7936*z^4 + ...
       6*(1 + 14*z + 36*z^2 + 24*z^3)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - 48*z*(1 + z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^...
         2 + 18*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^3) + ...
     18*sin(z)*(16*z^2*(209 + 214*z^3) + 6*(1 + 4*z + 12*z^2 + 16*z^3 + 8*z^4)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
       (9 + 6*z - 36*z^2 - 24*z^3)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + 9*(1 + 2*z)^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^...
         3)))/(72*(1 + 2*z + sin(z))^5*(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
    6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))));
for j=1:N
    for k=1:N
        z0=z(j,k);
        z0=R(z0); iter=1; dif=tol+1;
        while and(iter<maxiter,dif>tol)
            z0=R(z0);
            dif1=abs(z0-raices(1)); dif2=abs(z0-raices(2));
            dif=min([dif1,dif2]);
            iter=iter+1;
        end
        y(j,k)=z0;
        IT(j,k)=iter;
    end
end
p=polyfit([min(IT(:)) max(IT(:))],[1 .25],1);
cIT=polyval(p,IT);

Z1=abs(y-raices(1))<tol;
Z2=abs(y-raices(2))<tol;

I(:,:,1)=cIT.*(242/255*Z1+4/255*Z2);
I(:,:,2)=cIT.*(85/255*Z1+175/255*Z2);
I(:,:,3)=cIT.*(150/225*Z1+230/255*Z2);
figure, imshow(double(I),'XData',[li ls],'YData',[li ls]), axis on, axis xy
hold on
plot(real(raices),imag(raices),'w*'), xlabel('Real(z)'),...
    ylabel('Imag(z)'), grid
end

