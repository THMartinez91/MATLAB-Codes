function PlanoDinMGf24orden
%Dibuja el plano dinámico del método (MG4O) para la función f_2(x)

li=-3;ls=3;%Definimos los límites para los intervalos
N=500; maxiter=80; tol=1e-6;
x=linspace(li,ls,N); y=x;
[X,Y]=meshgrid(x,y);
z=X+1i*Y;

%Raíces de f_2(x)
raices=[-1.2511518352207648115928700687882, 0.55000934992726156666495361947173];

%Operador de punto fijo
R=@(z)(72*sqrt(3)*z + 672*sqrt(3)*z^2 + 2528*sqrt(3)*z^3 + 4584*sqrt(3)*z^4 + 3984*sqrt(3)*z^5 +... 
   1328*sqrt(3)*z^6 - 80*sqrt(3)*cos(z)^3 + 36*sqrt(3)*sin(2*z)^2 - ...
   18*sqrt(3)*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - ...
   246*sqrt(3)*z^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - ...
   804*sqrt(3)*z^3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - ...
   960*sqrt(3)*z^4*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) - ...
   384*sqrt(3)*z^5*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
   45*sqrt(3)*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
   225*sqrt(3)*z^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
   360*sqrt(3)*z^3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
   180*sqrt(3)*z^4*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
   24*sqrt(3)*cos(z)^2*(1 + 14*z + 14*z^2 + ...
     sin(z)*(7 + 14*z - 5*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) - ...
     5*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))) + ...
   72*z*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
         (3 + 6*z + 3*sin(z))) + 6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
         (3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + ...
        sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))) + ...
   576*z^2*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + ...
      3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))) + ...
   1728*z^3*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + ...
      3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))) + ...
   2304*z^4*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + ...
      3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))) + ...
   1152*z^5*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + ...
      3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
      3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))) - ...
   3*sqrt(3)*cos(z)*(8*(3 + 26*z + 92*z^2 + 132*z^3 + 66*z^4) + 45*sin(z)^4 + ...
     36*sin(z)^3*(4 + 8*z - sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
         (3 + 6*z + 3*sin(z)))) - 2*(3 + 58*z + 156*z^2 + 104*z^3)*...
      sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
     15*(1 + 2*z)^2*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
     3*sin(z)^2*(59 + 268*z + 268*z^2 - 26*(1 + 2*z)*...
        sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
       5*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2) +... 
     2*sin(z)*(51 + 362*z + 780*z^2 + 520*z^3 - 8*(3 + 17*z + 17*z^2)*...
        sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
       15*(1 + 2*z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2)) + ...
   9*z*sin(z)^4*(15*sqrt(3) + 15*sqrt(3)*z + ...
     8*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + ...
          sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))))) + ...
   9*z*sin(z)^2*(59*sqrt(3) + 311*sqrt(3)*z + 504*sqrt(3)*z^2 + 252*sqrt(3)*z^3 - ...
     26*sqrt(3)*(1 + 3*z + 2*z^2)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
        (3 + 6*z + 3*sin(z))) + 5*sqrt(3)*(1 + z)*...
      sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))^2 + ...
     48*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + ...
          sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))) + ...
     192*z*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + ...
          sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))) + ...
     192*z^2*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
           (3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + ...
          sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z)))))) + ...
   36*z*sin(z)^3*(-3*sqrt(3)*(1 + z)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
        (3 + 6*z + 3*sin(z))) + 4*(1 + 2*z)*(3*sqrt(3) + 3*sqrt(3)*z + ...
       2*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
             (3 + 6*z + 3*sin(z))) + 6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
             (3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + ...
            sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))))))) + ...
   6*z*sin(z)*(-4*sqrt(3)*(6 + 35*z + 58*z^2 + 29*z^3)*...
      sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
     15*sqrt(3)*(1 + 3*z + 2*z^2)*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
         (3 + 6*z + 3*sin(z)))^2 + (1 + 2*z)*(51*sqrt(3) + 283*sqrt(3)*z + ...
       464*sqrt(3)*z^2 + 232*sqrt(3)*z^3 + 48*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + ...
          3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
          6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
          3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*...
                sin(z))))) + 192*z*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + ...
          3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
          6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
          3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*...
                sin(z))))) + 192*z^2*sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + ...
          3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
          6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*sin(z))) + ...
          3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/(3 + 6*z + 3*...
                sin(z))))))))/(72*(1 + 2*z + sin(z))^4*...
   sqrt(3 + 8*z + 8*z^2 + 4*cos(z) + 3*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
        (3 + 6*z + 3*sin(z))) + 6*z*sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
        (3 + 6*z + 3*sin(z))) + 3*sin(z)*(1 + 2*z + sin((z + 4*z^2 + 2*cos(z) + 3*z*sin(z))/...
         (3 + 6*z + 3*sin(z))))));
for j=1:N
    for k=1:N
        z0=z(j,k);
        z0=R(z0); iter=1; dif=tol+1;
        while and(iter<maxiter,dif>tol)
            z0=R(z0);
            dif1=abs(z0-raices(1)); dif2=abs(z0-raices(2));
            dif=min([dif1,dif2]);
            iter=iter+1;
        end
        y(j,k)=z0;
        IT(j,k)=iter;
    end
end
p=polyfit([min(IT(:)) max(IT(:))],[1 .25],1);
cIT=polyval(p,IT);

Z1=abs(y-raices(1))<tol;
Z2=abs(y-raices(2))<tol;

I(:,:,1)=cIT.*(242/255*Z1+4/255*Z2);
I(:,:,2)=cIT.*(85/255*Z1+175/255*Z2);
I(:,:,3)=cIT.*(150/225*Z1+230/255*Z2);

figure, imshow(double(I),'XData',[li ls],'YData',[li ls]), axis on, axis xy
hold on
plot(real(raices),imag(raices),'w*'), xlabel('Real(z)'),...
    ylabel('Imag(z)'), grid
end

