function PlanoDinMCf14orden
%Dibuja el plano dinámico del método (MC4O) para la función f_1(x)

li=-3;ls=3;%Definimos los límites para los intervalos
N=500; maxiter=80; tol=1e-6;
x=linspace(li,ls,N); y=x;
[X,Y]=meshgrid(x,y);
z=X+1i*Y;

%Raíces del polinomio
raices=roots([1 4 0 -10]);

%Operador de punto fijo
R=@(z)(1400000 + 8960000*z + 21616000*z^2 + 15132000*z^3 - 28396800*z^4 -... 
61870400*z^5 - 7178280*z^6 - 188020*z^14 - 9401*z^15 + 3*z^13*(-533152 +... 
729*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z + 1267200*z^2 + ...
1955200*z^3 + 2731520*z^4 + 3009920*z^5 + 3769776*z^6 + 4574720*z^7 + ...
3646240*z^8 + 1734552*z^9 + 480064*z^10 + 71696*z^11 + 4481*z^12))) + ...
256*z^7*(300055 + 3072*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z + ...
1267200*z^2 + 1955200*z^3 + 2731520*z^4 + 3009920*z^5 + ...
3769776*z^6 + 4574720*z^7 + 3646240*z^8 + 1734552*z^9 + 480064*z^10 + ...
71696*z^11 + 4481*z^12))) + 512*z^8*(147973 + ...
3456*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z + 1267200*z^2 + ...
1955200*z^3 + 2731520*z^4 + 3009920*z^5 + 3769776*z^6 + 4574720*z^7 +... 
3646240*z^8 + 1734552*z^9 + 480064*z^10 + 71696*z^11 + 4481*z^12))) + ...
64*z^11*(-296381 + 3645*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z +... 
1267200*z^2 + 1955200*z^3 + 2731520*z^4 + 3009920*z^5 + ...
3769776*z^6 + 4574720*z^7 + 3646240*z^8 + 1734552*z^9 + 480064*z^10 + ...
71696*z^11 + 4481*z^12))) + 4*z^12*(-1844741 + ...
8748*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z + 1267200*z^2 + ...
1955200*z^3 + 2731520*z^4 + 3009920*z^5 + 3769776*z^6 + 4574720*z^7 + ...
3646240*z^8 + 1734552*z^9 + 480064*z^10 + 71696*z^11 + 4481*z^12))) + ...
128*z^9*(112889 + 12960*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z +... 
1267200*z^2 + 1955200*z^3 + 2731520*z^4 + 3009920*z^5 + ...
3769776*z^6 + 4574720*z^7 + 3646240*z^8 + 1734552*z^9 + 480064*z^10 + ...
71696*z^11 + 4481*z^12))) + 32*z^10*(-675439 + ...
25920*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z + 1267200*z^2 + ...
1955200*z^3 + 2731520*z^4 + 3009920*z^5 + 3769776*z^6 + 4574720*z^7 + ...
3646240*z^8 + 1734552*z^9 + 480064*z^10 + 71696*z^11 + 4481*z^12))))/...
(3*z^6*(8 + 3*z)^6*sqrt((1/(z^4*(8 + 3*z)^4))*(80000 + 512000*z + 1267200*z^2+... 
1955200*z^3 + 2731520*z^4 + 3009920*z^5 + 3769776*z^6 + ...
4574720*z^7 + 3646240*z^8 + ...
 1734552*z^9 + 480064*z^10 + 71696*z^11 + 4481*z^12)));
  
for j=1:N
    for k=1:N
        z0=z(j,k);
        z0=R(z0); iter=1; dif=tol+1;
        while and(iter<maxiter,dif>tol)
            z0=R(z0);
            dif1=abs(z0-raices(1)); dif2=abs(z0-raices(2));
            dif3=abs(z0-raices(3));
            dif=min([dif1,dif2,dif3]);
            iter=iter+1;
        end
        y(j,k)=z0;
        IT(j,k)=iter;
    end
end
p=polyfit([min(IT(:)) max(IT(:))],[1 .25],1);
cIT=polyval(p,IT);

Z1=abs(y-raices(1))<tol;
Z2=abs(y-raices(2))<tol;
Z3=abs(y-raices(3))<tol;

I(:,:,1)=cIT.*(237/255*Z1+3/255*Z3+100/255*Z2);
I(:,:,2)=cIT.*(85/255*Z1+102/255*Z2+200/255*Z3);
I(:,:,3)=cIT.*(70/225*Z1+205/255*Z2+79/255*Z3);

figure, imshow(double(I),'XData',[li ls],'YData',[li ls]), axis on, axis xy
hold on
plot(real(raices),imag(raices),'w*'), xlabel('Real(z)'),...
    ylabel('Imag(z)'), grid
end

